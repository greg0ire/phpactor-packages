Content-Length:382

{"jsonrpc":"2.0","method":"initialize","params":{"capabilities":{"textDocument":{"completion":{"completionItem":{"snippetSupport":false}}},"workspace":{"applyEdit":true,"didChangeWatchedFiles":{"dynamicRegistration":true}}},"processId":2153,"rootPath":"/home/daniel/www/phpactor/language-server","rootUri":"file:///home/daniel/www/phpactor/language-server","trace":"off"},"id":2597}Content-Length:52

{"jsonrpc":"2.0","method":"initialized","params":{}}Content-Length:1770

{"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"languageId":"php","text":"<?php\n\nnamespace Phpactor\\LanguageServer\\Core\\Protocol;\n\nuse Phpactor\\LanguageServer\\Core\\IO;\nuse Phpactor\\LanguageServer\\Core\\Protocol;\nuse Phpactor\\LanguageServer\\Core\\Reader;\nuse Phpactor\\LanguageServer\\Core\\Transport\\Request;\nuse RuntimeException;\n\nclass RecordingProtocol implements Protocol\n{\n    /**\n     * @var Protocol\n     */\n    private $innerProtocol;\n\n    /**\n     * @var resource\n     */\n    private $recordStream;\n\n    public function __construct(Protocol $innerProtocol, string $recordPath)\n    {\n        $this->innerProtocol = $innerProtocol;\n        $stream = fopen($recordPath, 'w');\n\n        if (false === $stream) {\n            throw new RuntimeException(sprintf(\n                'Could not open stream \"%s\"',\n                $recordPath\n            ));\n        }\n\n        $this->recordStream = $stream;\n    }\n\n    public function readRequest(IO $io): Request\n    {\n        $request = $this->innerProtocol->readRequest($io);\n        fwrite($this->recordStream, implode(\"\\r\\n\", array_map(function ($key, $value) {\n            return $key .':'.$value;\n        }, array_keys($request->headers()), array_values($request->headers()))) . \"\\r\\n\\r\\n\");\n        fwrite($this->recordStream, $request->body());\n        return $request;\n    }\n\n    public function __destruct()\n    {\n        fclose($this->recordStream);\n    }\n\n    public function writeResponse(IO $io, $response): void\n    {\n        $this->innerProtocol->writeResponse($io, $response);\n    }\n}\n","uri":"file:///home/daniel/www/phpactor/language-server/lib/Core/Protocol/RecordingProtocol.php","version":0}}}Content-Length:47

{"jsonrpc":"2.0","method":"exit","params":null}
